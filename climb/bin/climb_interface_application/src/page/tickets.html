<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerenciamento de Tickets</title>
  <link rel="stylesheet" href="../../libs/bootstrap.min.css">
  <link rel="stylesheet" href="../../src/style/componentsStyle.css">

  <style>
    body {
      background-color: #f4f6f9;
    }
    .ticket-card {
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      transition: 0.2s;
      height: 100%;
    }
    .ticket-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <div class="form-card card shadow-sm p-4">
      <h2 class="text-center color-primary mb-5">Gerenciamento de Tickets</h2>

      <div class="row g-4" id="tickets-container">

      </div>
    </div>
  </div>


  <script>
    async function carregarChamados() {
  try {
    const token = localStorage.getItem("token"); // token salvo no login
    if (!token) {
      alert("Token não encontrado. Faça login novamente.");
      return;
    }

    const response = await fetch("/chamado/all", {
      headers: {
        "Authorization": "Bearer " + token
      }
    });

    if (!response.ok) {
      throw new Error("Erro ao buscar chamados: " + response.status);
    }

    const chamados = await response.json();
    const container = document.getElementById("tickets-container");

    container.innerHTML = "";

    chamados.forEach(ch => {
      const card = `
        <div class="col-md-6 col-lg-4">
          <div class="card ticket-card">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <h5 class="card-title">${ch.motivo}</h5>
                <span class="badge ${getBadgeClass(ch.status)}">${ch.status}</span>
              </div>
              <p class="card-text mt-2">${ch.descricao}</p>
              <p class="small text-muted">
                Aberto por: ${ch.responsavelAbertura ? ch.responsavelAbertura.nome : "Desconhecido"} 
                | Urgência: ${ch.urgencia}
              </p>
            </div>
            <div class="card-footer d-flex justify-content-between">
              <button class="btn btn-sm btn-outline-primary">Editar</button>
              <button class="btn btn-sm btn-outline-danger">Excluir</button>
            </div>
          </div>
        </div>
      `;
      container.insertAdjacentHTML("beforeend", card);
    });

  } catch (error) {
    console.error("Erro:", error);
  }
}
  </script>

  <script src="../../libs/bootstrap.bundle.min.js"></script>

</body>
</html>
